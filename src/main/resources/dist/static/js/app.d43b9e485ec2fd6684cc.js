webpackJsonp([14],{0:function(e,t){},1:function(e,t){},"4FHq":function(e,t){!function(e,t){var n,a=e.document,r=a.documentElement,o=a.querySelector('meta[name="viewport"]'),i=a.querySelector('meta[name="flexible"]'),s=0,c=0,l=t.flexible||(t.flexible={});if(o){console.warn("将根据已有的meta标签来设置缩放比例");var u=o.getAttribute("content").match(/initial\-scale=([\d\.]+)/);u&&(c=parseFloat(u[1]),s=parseInt(1/c))}else if(i){var m=i.getAttribute("content");if(m){var d=m.match(/initial\-dpr=([\d\.]+)/),p=m.match(/maximum\-dpr=([\d\.]+)/);d&&(s=parseFloat(d[1]),c=parseFloat((1/s).toFixed(2))),p&&(s=parseFloat(p[1]),c=parseFloat((1/s).toFixed(2)))}}if(!s&&!c){e.navigator.appVersion.match(/android/gi);var f=e.navigator.appVersion.match(/iphone/gi),v=e.devicePixelRatio;c=1/(s=f?v>=3&&(!s||s>=3)?3:v>=2&&(!s||s>=2)?2:1:1)}if(r.setAttribute("data-dpr",s),!o)if((o=a.createElement("meta")).setAttribute("name","viewport"),o.setAttribute("content","initial-scale="+c+", maximum-scale="+c+", minimum-scale="+c+", user-scalable=no"),r.firstElementChild)r.firstElementChild.appendChild(o);else{var h=a.createElement("div");h.appendChild(o),a.write(h.innerHTML)}function g(){var t=r.getBoundingClientRect().width;t/s>540&&(t*=s);var n=t/10;r.style.fontSize=n+"px",l.rem=e.rem=n}e.addEventListener("resize",function(){clearTimeout(n),n=setTimeout(g,300)},!1),e.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(n),n=setTimeout(g,300))},!1),"complete"===a.readyState?a.body.style.fontSize=12*s+"px":a.addEventListener("DOMContentLoaded",function(e){a.body.style.fontSize=12*s+"px"},!1),g(),l.dpr=e.dpr=s,l.refreshRem=g,l.rem2px=function(e){var t=parseFloat(e)*this.rem;return"string"==typeof e&&e.match(/rem$/)&&(t+="px"),t},l.px2rem=function(e){var t=parseFloat(e)/this.rem;return"string"==typeof e&&e.match(/px$/)&&(t+="rem"),t}}(window,window.lib||(window.lib={}))},Fm67:function(e,t){},JC5E:function(e,t,n){"use strict";var a=n("mtWM"),r=n.n(a),o=n("YaEn"),i=n("zL8q");n.n(i);r.a.defaults.timeout=8e3,r.a.defaults.baseURL="",r.a.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.satoken=t),e},e=>Promise.reject(e));let s=0;r.a.interceptors.response.use(e=>(401===e.data.code&&(console.log("666666",s),0==s++&&(setTimeout(()=>{s=0},2e3),localStorage.removeItem("token"),o.a.push({name:"login",params:{to:-1}}),Object(i.Message)({message:e.data.msg,type:"error"}))),e),e=>Promise.reject(e)),t.a=r.a},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var o=n("VU/8")({name:"App"},r,!1,function(e){n("Fm67")},null,null).exports,i=n("YaEn"),s=n("zL8q"),c=n.n(s),l=(n("tvR6"),n("4FHq"),n("JC5E")),u=n("XLwt"),m=n("NC6I"),d=n.n(m);a.default.use(c.a),a.default.config.productionTip=!1,a.default.prototype.$http=l.a,a.default.prototype.$echarts=u,a.default.prototype.$md5=d.a,new a.default({el:"#app",router:i.a,components:{App:o},template:"<App/>"})},YaEn:function(e,t,n){"use strict";var a=n("7+uW"),r=n("/ocq");n("lmfZ");a.default.use(r.a);var o=r.a.prototype.push;r.a.prototype.push=function(e){return o.call(this,e).catch(function(e){return e})};var i=new r.a({scrollBehavior:function(e,t,n){return{x:0,y:0}},routes:[{path:"/",redirect:"/login"},{path:"/login/:to?",name:"login",component:function(){return new Promise(function(e){e()}).then(n.bind(null,"lmfZ"))},meta:{title:"登录"}},{path:"/layout",component:function(){return n.e(5).then(n.bind(null,"hMmo"))},redirect:"/layout/home",children:[{path:"home",name:"home",component:function(){return n.e(1).then(n.bind(null,"j7e0"))},meta:{title:"首页"}},{path:"device-list",name:"deviceList",component:function(){return n.e(9).then(n.bind(null,"0Dvh"))},meta:{title:"设备列表"}},{path:"warn-list",name:"warnList",component:function(){return n.e(10).then(n.bind(null,"Yqxx"))},meta:{title:"报警列表"}},{path:"device-detail/:name/:deviceId/:deviceTypeId",name:"deviceDetail",component:function(){return n.e(0).then(n.bind(null,"bTUx"))},meta:{title:"设备详情"}}]},{path:"/admin",name:"admin",component:function(){return n.e(3).then(n.bind(null,"vvZ0"))},redirect:"/admin/home-index",children:[{path:"home-index",name:"home_index",component:function(){return n.e(2).then(n.bind(null,"smE5"))},meta:{title:"首页",icon:"el-icon-s-home",breadcrumb:!1}},{path:"device-mange",name:"device_manage",component:function(){return n.e(4).then(n.bind(null,"RLHB"))},meta:{title:"设备管理",icon:"el-icon-s-platform"}},{path:"set-camera/:deviceId/:deviceName",name:"set_camera",component:function(){return n.e(7).then(n.bind(null,"NNpK"))},meta:{title:"设备管理",icon:"el-icon-s-platform"},hidden:!0},{path:"device-type-manage",name:"device_type_manage",component:function(){return n.e(11).then(n.bind(null,"SLDh"))},meta:{title:"设备类型管理",icon:"el-icon-menu"}},{path:"device-param-manage/:deviceTypeId/:deviceTypeName",name:"device_param_manage",component:function(){return n.e(8).then(n.bind(null,"x6kb"))},meta:{title:"设备类型管理",icon:"el-icon-menu"},hidden:!0},{path:"user-manage",name:"user_manage",component:function(){return n.e(6).then(n.bind(null,"5Xle"))},meta:{title:"用户管理",icon:"el-icon-user-solid"}},{path:"system-manage",name:"system_manage",component:function(){return n.e(12).then(n.bind(null,"kzZL"))},meta:{title:"系统管理",icon:"el-icon-s-tools"}}]}]});i.beforeEach(function(e,t,n){if(document.title=e.meta.title+" | 山东金科星机电股份有限公司","login"===e.name)n();else{var a=localStorage.getItem("token");null===a||""===a?n({name:"login",params:{to:-1}}):n()}}),t.a=i},lmfZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("//Fk"),r=n.n(a),o=n("Xxa5"),i=n.n(o),s=n("mvHQ"),c=n.n(s),l=n("exGp"),u=n.n(l),m={name:"Login",data:function(){return{userInfo:{account:"",password:""},rules:{account:[{required:!0,message:"账号不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]},imageUrl:"",is_active:!1,active:""}},created:function(){this.getVerify()},mounted:function(){this.getTitleImage(),window.addEventListener("keydown",this.keyDown)},destroyed:function(){window.removeEventListener("keydown",this.keyDown,!1)},methods:{keyDown:function(e){13===e.keyCode&&this.submitForm("userInfo")},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.login()})},resetForm:function(e){this.$refs[e].resetFields()},login:function(){var e=this;return u()(i.a.mark(function t(){var n,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/user/loginPC",{userName:e.userInfo.account,password:e.userInfo.password});case 3:n=t.sent,a=n.data,console.log("登录成功",a),200===a.code?(localStorage.setItem("token",a.data.tokenInfo.tokenValue),localStorage.setItem("user_info",c()(a.data.user)),localStorage.setItem("mapInfo",c()({x:0,y:0,scale:1})),e.$message.success("登录成功"),e.$route.params.to?e.$router.go(-1):e.$router.push({name:"home"})):e.$message.error(a.msg),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},getTitleImage:function(){var e=this;return u()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/system/query");case 3:n=t.sent,e.imageUrl=n.data.data.mapPath,e.preloadImage(e.imageUrl),localStorage.setItem("system",c()(n.data.data)),-1==n.data.data.websocketURL.indexOf("ws://")&&e.$message.error(n.data.data.websocketURL),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}},t,e,[[0,10]])}))()},preloadImage:function(e){return new r.a(function(t,n){var a=new Image;a.onload=function(){return t(a)},a.onerror=function(){return n(new Error("图片加载失败"))},a.src=e})},getVerify:function(){var e=this;return u()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/system/verify");case 3:200==t.sent.data.code&&(e.is_active=!0),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},register:function(){var e=this;return u()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/system/register",{activationCode:e.active});case 3:200==(n=t.sent).data.code?(e.$message.success("激活成功"),e.is_active=!0):e.$message.error(n.data.msg),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout-bg"},[n("div",{staticClass:"login-bg"},[n("h1",[e._v("欢迎登录金科星SCADA系统")]),e._v(" "),n("h3",[e._v("WELCOME TO JINKEXING SCADA SYSTEM")]),e._v(" "),n("div",{staticClass:"form-box"},[e.is_active?n("el-form",{ref:"userInfo",staticClass:"user-info",attrs:{model:e.userInfo,"status-icon":"",rules:e.rules}},[n("el-form-item",{attrs:{prop:"account"}},[n("el-input",{staticClass:"input-box",attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入账号",autocomplete:"off"},model:{value:e.userInfo.account,callback:function(t){e.$set(e.userInfo,"account",t)},expression:"userInfo.account"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("el-input",{staticClass:"input-box",attrs:{"prefix-icon":"el-icon-unlock",placeholder:"请输入密码","show-password":""},model:{value:e.userInfo.password,callback:function(t){e.$set(e.userInfo,"password",t)},expression:"userInfo.password"}})],1),e._v(" "),n("el-form-item",{staticClass:"item-box"},[n("div",{staticClass:"login-button",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.keyDown.apply(null,arguments)},click:function(t){return e.submitForm("userInfo")}}},[e._v("用户登录")])])],1):n("el-form",{staticClass:"user-info"},[n("el-form-item",[n("el-input",{staticClass:"input-box",attrs:{placeholder:"系统未激活，请填写激活码或联系管理员",disabled:""}})],1),e._v(" "),n("el-form-item",[n("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入激活码"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}})],1),e._v(" "),n("el-form-item",{staticClass:"item-box"},[n("div",{staticClass:"login-button",on:{click:e.register}},[e._v("立即激活")])])],1)],1)])])},staticRenderFns:[]};var p=n("VU/8")(m,d,!1,function(e){n("sjAC")},"data-v-bc90652a",null);t.default=p.exports},sjAC:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
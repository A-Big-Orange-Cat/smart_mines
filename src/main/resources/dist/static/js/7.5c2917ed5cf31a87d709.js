webpackJsonp([7],{NNpK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),o=r("exGp"),i=r.n(o),n={name:"CameraModal",props:{visible:Boolean,addOrEdit:String,cameraInfo:Object},data:function(){return{title:"",form:{ip:"",port:8e3,userName:"",password:""},rules:{ip:[{required:!0,message:"ip地址不能为空",trigger:"blur"}],port:[{required:!0,message:"端口号不能为空",trigger:"blur"}],userName:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]}}},watch:{addOrEdit:{handler:function(e){this.title="add"==e?"新建摄像头":"编辑摄像头"}},visible:{handler:function(e){var t=this;e&&"edit"==this.addOrEdit&&this.$nextTick(function(){t.form.ip=t.cameraInfo.ip,t.form.port=t.cameraInfo.port,t.form.userName=t.cameraInfo.userName,t.form.password=t.cameraInfo.password})},immediate:!0}},methods:{updateVisible:function(e){this.$refs.form.resetFields(),this.$emit("update:visible",e)},submitForm:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return console.log("error submit!!"),!1;"add"==e.addOrEdit?e.insertCamera():e.updateCamera()})},insertCamera:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("deviceId:",e.cameraInfo.deviceId),t.prev=1,t.next=4,e.$http.post("/hik/insert",{deviceId:Number(e.$route.params.deviceId),ip:e.form.ip,port:e.form.port,userName:e.form.userName,password:e.form.password});case 4:200==(r=t.sent).data.code?(e.$message.success("添加成功"),e.updateVisible(!1),e.$parent.queryCamera()):e.$message.error(r.data.msg),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:case"end":return t.stop()}},t,e,[[1,8]])}))()},updateCamera:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/hik/update",{deviceId:Number(e.$route.params.deviceId),dvrId:e.cameraInfo.dvrId,ip:e.form.ip,port:e.form.port,userName:e.form.userName,password:e.form.password});case 3:200==(r=t.sent).data.code?(e.$message.success("编辑成功"),e.updateVisible(!1),e.$parent.queryCamera()):e.$message.error(r.data.msg),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"modal",attrs:{title:e.title,visible:e.visible,width:"30%","close-on-click-modal":!1},on:{"update:visible":e.updateVisible}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"right","label-width":"70px"}},[r("el-form-item",{attrs:{label:"ip地址",prop:"ip"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入ip地址"},model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"端口号",prop:"port"}},[r("el-input-number",{staticClass:"input-number",attrs:{"controls-position":"right",min:0,placeholder:"请输入端口号"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入用户名"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.updateVisible(!1)}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var c={name:"SetCamera",components:{CameraModal:r("VU/8")(n,l,!1,function(e){r("ZAdm")},"data-v-112cefb0",null).exports},data:function(){return{tableData:[],cameraVisible:!1,addOrEdit:"",cameraInfo:{}}},created:function(){this.queryCamera()},methods:{goBack:function(){this.$router.go(-1)},handleEdit:function(e){this.addOrEdit="edit",this.cameraInfo=e,this.cameraVisible=!0},addCamera:function(){this.addOrEdit="add",this.cameraVisible=!0},queryCamera:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/hik/queryAllByDeviceId",{deviceId:Number(e.$route.params.deviceId)});case 3:200==(r=t.sent).data.code?e.tableData=r.data.data:e.$message.error(r.data.msg),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},deleteCamera:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$http.post("/hik/delete",{dvrId:e.dvrId});case 3:200==(a=r.sent).data.code?(t.$message.success("删除摄像头成功"),t.queryCamera()):t.$message.error(a.data.msg),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),console.log(r.t0);case 10:case"end":return r.stop()}},r,t,[[0,7]])}))()}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"box-card"},[r("el-page-header",{attrs:{content:e.$route.params.deviceName},on:{back:e.goBack}})],1),e._v(" "),r("div",{staticClass:"box-table"},[r("el-button",{staticClass:"space-button",attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:e.addCamera}},[e._v("新建")]),e._v(" "),r("el-table",{attrs:{data:e.tableData,border:!0,stripe:!0}},[r("el-table-column",{attrs:{type:"index",width:"80",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"ip",label:"ip地址",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"port",label:"端口号",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userName",label:"用户名",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"password",label:"密码",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(r){return e.deleteCamera(t.row)}}},[r("el-button",{attrs:{slot:"reference",type:"text",size:"small"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1),e._v(" "),r("camera-modal",{attrs:{visible:e.cameraVisible,addOrEdit:e.addOrEdit,cameraInfo:e.cameraInfo},on:{"update:visible":function(t){e.cameraVisible=t}}})],1)},staticRenderFns:[]};var m=r("VU/8")(c,d,!1,function(e){r("PikV")},"data-v-f8cd3f38",null);t.default=m.exports},PikV:function(e,t){},ZAdm:function(e,t){}});